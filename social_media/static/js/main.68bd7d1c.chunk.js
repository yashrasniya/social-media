(this["webpackJsonpinstagram-react"]=this["webpackJsonpinstagram-react"]||[]).push([[0],{105:function(e,t,c){"use strict";c.r(t);var o=c(1),n=c.n(o),s=c(48),r=c.n(s),a=(c(53),c.p,c(54),c(35)),i=c(7);function l(e){var t=null;if(document.cookie&&""!==document.cookie)for(var c=document.cookie.split(";"),o=0;o<c.length;o++){var n=c[o].trim();if(n.substring(0,e.length+1)===e+"="){t=decodeURIComponent(n.substring(e.length+1));break}}return t}function d(e,t,c,o){var n,s=!(arguments.length>4&&void 0!==arguments[4])||arguments[4];o&&(n=s?JSON.stringify(o):o);var r=new XMLHttpRequest,a=l("csrftoken");console.log(a);var i="http://127.0.0.1:8000/api/".concat(t);r.responseType="json",r.open(e,i),s&&r.setRequestHeader("Content-Type","application/json"),r.setRequestHeader("Authorization","Token 08f49cec6f948906b3c15882d53ab507567753bf"),a&&(console.log("csrf token"),r.setRequestHeader("HTTP_X_REQUESTED_WITH","XMLHttpRequest"),r.setRequestHeader("X-Requested-With","XMLHttpRequest"),r.setRequestHeader("X-CSRFToken",a)),r.onload=function(){c(r.response,r.status)},r.onerror=function(e){console.log(e),console.log(r.response,r.status),c({message:"this request have a error"},400)},r.send(n)}function u(e,t){d("POST","post/action",t,e,!0)}c(55);var j=c(0);function m(e){var t=n.a.createRef(),c=n.a.createRef(),s=(function(e){var t=null;if(document.cookie&&""!==document.cookie)for(var c=document.cookie.split(";"),o=0;o<c.length;o++){var n=c[o].trim();if(n.substring(0,e.length+1)===e+"="){t=decodeURIComponent(n.substring(e.length+1));break}}}("csrftoken"),Object(o.useState)([])),r=Object(i.a)(s,2),l=r[0],u=r[1];return Object(j.jsxs)("div",{className:"col ",children:[Object(j.jsx)("div",{className:"row m-3",children:Object(j.jsx)("div",{className:"mb-1 col-md-4 mx-auto ",children:Object(j.jsxs)("form",{onSubmit:function(e){e.preventDefault();var o=e.target,n=new FormData(o);console.log(o.textarea,o,n,n.responce);var s=t.current.value,r=c.current.value;console.log(s,e,r,n.post_description);var i=Object(a.a)(l);!function(e,t,c){d("POST","post_upload",c,e,!1)}(n,0,(function(e,t){201===t?(i.unshift(e),u(i)):(alert("There is a error!"),console.log(e))})),t.current.value="",c.current.value=""},className:"form ",children:[Object(j.jsx)("textarea",{ref:t,required:!0,className:"form-control  col-12 mb-1",name:"post_description"}),Object(j.jsx)("div",{className:"col-12 ",children:Object(j.jsx)("input",{type:"file",ref:c,className:" col-4 mb-1",accept:"image/jpg",name:"photo",required:"true"})}),Object(j.jsx)("button",{type:"submit",className:"btn-primary  col-12",children:"post"})]})})}),Object(j.jsx)("div",{className:"row row-cols-1 row-cols-md-2 g-4 d-flex justify-content-center",children:Object(j.jsx)("div",{className:"col-md-5 justify-content-md-center   ",children:Object(j.jsx)("div",{className:"row row-cols-100 row-cols-md-1 g-4",children:Object(j.jsx)(b,{newPost:l})})})})]})}function b(e){var t=Object(o.useState)([]),c=Object(i.a)(t,2),n=c[0],s=c[1],r=Object(o.useState)([]),l=Object(i.a)(r,2),u=l[0],m=l[1],b=Object(o.useState)(!1),f=Object(i.a)(b,2),h=f[0],O=f[1];return Object(o.useEffect)((function(){var t=Object(a.a)(e.newPost).concat(n);t.length!==u.length&&m(t)}),[e.newPost,u,n]),Object(o.useEffect)((function(){if(!1===h){d("GET","post_detial_view",(function(e,t){200===t?(s(e.data),O(!0)):alert("there was an error")}))}}),[n,O,h]),u.map((function(e,t){return Object(j.jsx)(p,{post:e,className:"col"},t)}))}function p(e){var t=e.post;console.log(e.post.post_comment);e.post.post_comment;function c(e,t){e.preventDefault();var c=new FormData(e.target);console.log(t),c.append("post",t),function(e,t){d("POST","post/do_comment",t,e,!1)}(c,(function(c,o){200===o?(window.location.href="http://127.0.0.1:8000/post/post-id="+t,e.target.reset()):(!function(e){403===e&&alert("you are not login"),500===e&&alert("server side error")}(o),alert("there is an error"))}))}return Object(j.jsxs)("div",{className:"card",children:[Object(j.jsx)("div",{className:"m-2",children:Object(j.jsx)("a",{href:"http://127.0.0.1:8000/post/post-id="+t.id,children:Object(j.jsx)("img",{id:t.id,src:t.photo,className:"card-img-top",alt:"..."})})}),Object(j.jsxs)("div",{className:"container-auto",children:[Object(j.jsxs)("div",{className:"row",children:[Object(j.jsx)("div",{className:"col-8",children:Object(j.jsx)("div",{className:"card-body ",children:Object(j.jsx)("h5",{className:"card-title text-secondary",style:{colors:"Black"},children:t.post_description})})}),Object(j.jsx)("div",{className:"col ",children:Object(j.jsx)("div",{className:"card-body  mb-2",children:Object(j.jsx)(f,{post:t,action:{type:"like"}})})})]}),Object(j.jsx)("form",{onSubmit:function(e){c(e,t.id)},children:Object(j.jsx)("div",{className:"col container",children:Object(j.jsxs)("div",{className:"row ",children:[Object(j.jsx)("div",{className:"col-8",children:Object(j.jsx)("div",{className:"row",children:Object(j.jsx)("input",{type:"text ",name:"comment",className:"col-12 mt-1 border rounded-pill",required:!0})})}),Object(j.jsx)("div",{className:"col",children:Object(j.jsx)("button",{className:"btn border rounded-pill ",children:"comment"})})]})})}),Object(j.jsx)("div",{className:"row m-3"})]})]})}function f(e){var t=e.post,c=e.action,n=Object(o.useState)(t.likes?t.likes:0),s=Object(i.a)(n,2),r=s[0],a=s[1],l=Object(o.useState)(t.is_like),d=Object(i.a)(l,2),m=d[0],b=d[1],p=e.className?e.className:"btn btn-primary btn-sm",f=function(e){e.preventDefault(),m?u({id:t.id,action:"unlike"},(function(e,t){200==t&&(e.DoLikes?(b(!1),a(e.likes),console.log(r)):(console.log("like"),b(!1)))})):(console.log("unlike req"),u({id:t.id,action:"like"},(function(e,t){200==t&&(e.DoLikes?(b(!0),a(e.likes),console.log(r)):(console.log("unlike"),b(!0)))})))};return Object(j.jsxs)("button",{className:p,onClick:f,children:[r," ",c.type]})}var h=function(){return Object(j.jsx)(m,{})},O=function(e){e&&e instanceof Function&&c.e(3).then(c.bind(null,106)).then((function(t){var c=t.getCLS,o=t.getFID,n=t.getFCP,s=t.getLCP,r=t.getTTFB;c(e),o(e),n(e),s(e),r(e)}))};r.a.render(Object(j.jsx)(n.a.StrictMode,{children:Object(j.jsx)(h,{})}),document.getElementById("root")),O()},53:function(e,t,c){},54:function(e,t,c){}},[[105,1,2]]]);
//# sourceMappingURL=main.68bd7d1c.chunk.js.map